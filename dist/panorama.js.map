{"version":3,"sources":["webpack:///panorama.js","webpack:///webpack/bootstrap 2ba1bcd0b8b0d25eba99","webpack:///./src/lib/panorama.js","webpack:///./src/lib/orienter.js","webpack:///./src/lib/toucher.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","parentJsonpFunction","window","chunkIds","moreModules","executeModules","chunkId","result","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","shift","s","1","e","onScriptComplete","script","onerror","onload","clearTimeout","timeout","chunk","Error","undefined","installedChunkData","Promise","resolve","promise","reject","head","document","getElementsByTagName","createElement","type","charset","async","nc","setAttribute","src","p","0","setTimeout","appendChild","m","c","d","name","getter","o","defineProperty","configurable","enumerable","get","n","__esModule","object","property","oe","err","console","error","_interopRequireDefault","obj","default","_classCallCheck","instance","Constructor","TypeError","value","_createClass","defineProperties","target","props","descriptor","writable","key","protoProps","staticProps","_orienter","_orienter2","_toucher","_toucher2","Panorama","config","this","_config","assign","url","container","body","radius","fov","offsetLongitude","offsetLatitude","supportTouch","supportOrient","onFrame","lon","lat","width","clientWidth","height","clientHeight","_fix","isFixed","_touch","_orient","_initStage","resize","_animate","_initControl","arguments","renderer","setSize","camera","aspect","updateProjectionMatrix","lookAt","render","scene","THREE","PerspectiveCamera","Vector3","Scene","geometry","SphereBufferGeometry","scale","material","MeshBasicMaterial","map","TextureLoader","load","mesh","Mesh","add","WebGLRenderer","setPixelRatio","devicePixelRatio","canvas","domElement","addEventListener","_bindResize","_onResize","bind","update","self","onChange","_ref","Math","min","max","_ref2","abs","unbind","destroy","removeEventListener","cancelAnimationFrame","_intFrame","degToRad","x","cos","y","sin","z","requestAnimationFrame","Orienter","onOrient","offsetMooth","direction","orientation","_bindChange","_onChange","_bindOrient","_onOrient","event","lastLon","lastLat","lx","evt","alpha","gamma","beta","_mooth","Toucher","onStart","onMove","onEnd","lastX","lastY","lastDistance","startX","startY","speed","deceleration","factor","_bindStart","_onStart","_bindMove","_onMove","_bindEnd","_onEnd","changedTouches","clientX","clientY","startTime","Date","now","preventDefault","evt1","distance","t","_inertance","_subSpeed","isUserInteracting"],"mappings":"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","file":"panorama.js?ed464704257860ee4439","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// install a JSONP callback for chunk loading\n/******/ \tvar parentJsonpFunction = window[\"webpackJsonp\"];\n/******/ \twindow[\"webpackJsonp\"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {\n/******/ \t\t// add \"moreModules\" to the modules object,\n/******/ \t\t// then flag all \"chunkIds\" as loaded and fire callback\n/******/ \t\tvar moduleId, chunkId, i = 0, resolves = [], result;\n/******/ \t\tfor(;i < chunkIds.length; i++) {\n/******/ \t\t\tchunkId = chunkIds[i];\n/******/ \t\t\tif(installedChunks[chunkId]) {\n/******/ \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n/******/ \t\t\t}\n/******/ \t\t\tinstalledChunks[chunkId] = 0;\n/******/ \t\t}\n/******/ \t\tfor(moduleId in moreModules) {\n/******/ \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n/******/ \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n/******/ \t\twhile(resolves.length) {\n/******/ \t\t\tresolves.shift()();\n/******/ \t\t}\n/******/ \t\tif(executeModules) {\n/******/ \t\t\tfor(i=0; i < executeModules.length; i++) {\n/******/ \t\t\t\tresult = __webpack_require__(__webpack_require__.s = executeModules[i]);\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t\treturn result;\n/******/ \t};\n/******/\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// objects to store loaded and loading chunks\n/******/ \tvar installedChunks = {\n/******/ \t\t1: 0\n/******/ \t};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/ \t// This file contains only the entry chunk.\n/******/ \t// The chunk loading function for additional chunks\n/******/ \t__webpack_require__.e = function requireEnsure(chunkId) {\n/******/ \t\tvar installedChunkData = installedChunks[chunkId];\n/******/ \t\tif(installedChunkData === 0) {\n/******/ \t\t\treturn new Promise(function(resolve) { resolve(); });\n/******/ \t\t}\n/******/\n/******/ \t\t// a Promise means \"currently loading\".\n/******/ \t\tif(installedChunkData) {\n/******/ \t\t\treturn installedChunkData[2];\n/******/ \t\t}\n/******/\n/******/ \t\t// setup Promise in chunk cache\n/******/ \t\tvar promise = new Promise(function(resolve, reject) {\n/******/ \t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n/******/ \t\t});\n/******/ \t\tinstalledChunkData[2] = promise;\n/******/\n/******/ \t\t// start chunk loading\n/******/ \t\tvar head = document.getElementsByTagName('head')[0];\n/******/ \t\tvar script = document.createElement('script');\n/******/ \t\tscript.type = 'text/javascript';\n/******/ \t\tscript.charset = 'utf-8';\n/******/ \t\tscript.async = true;\n/******/ \t\tscript.timeout = 120000;\n/******/\n/******/ \t\tif (__webpack_require__.nc) {\n/******/ \t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n/******/ \t\t}\n/******/ \t\tscript.src = __webpack_require__.p + \"\" + chunkId + \".js?\" + {\"0\":\"b40cb0b5c4f3dbea9676\"}[chunkId] + \"\";\n/******/ \t\tvar timeout = setTimeout(onScriptComplete, 120000);\n/******/ \t\tscript.onerror = script.onload = onScriptComplete;\n/******/ \t\tfunction onScriptComplete() {\n/******/ \t\t\t// avoid mem leaks in IE.\n/******/ \t\t\tscript.onerror = script.onload = null;\n/******/ \t\t\tclearTimeout(timeout);\n/******/ \t\t\tvar chunk = installedChunks[chunkId];\n/******/ \t\t\tif(chunk !== 0) {\n/******/ \t\t\t\tif(chunk) {\n/******/ \t\t\t\t\tchunk[1](new Error('Loading chunk ' + chunkId + ' failed.'));\n/******/ \t\t\t\t}\n/******/ \t\t\t\tinstalledChunks[chunkId] = undefined;\n/******/ \t\t\t}\n/******/ \t\t};\n/******/ \t\thead.appendChild(script);\n/******/\n/******/ \t\treturn promise;\n/******/ \t};\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// on error function for async loading\n/******/ \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _orienter = __webpack_require__(1);\n\nvar _orienter2 = _interopRequireDefault(_orienter);\n\nvar _toucher = __webpack_require__(2);\n\nvar _toucher2 = _interopRequireDefault(_toucher);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Panorama = function () {\n    function Panorama(config) {\n        _classCallCheck(this, Panorama);\n\n        this._config = Object.assign({\n            url: '', //全景图片\n            container: document.body, //容器\n            radius: 500, //球体半径\n            fov: 90, //相机视角，可用于放大和缩小图片\n            offsetLongitude: 0, //经度偏移量，可用于默认展示图片位置\n            offsetLatitude: 0, //纬度偏移量，可用于默认展示图片位置\n            supportTouch: true, //是否支持手指滑动\n            supportOrient: true, //是否支持陀螺仪\n            onFrame: function onFrame(lon, lat) {\n                return { lon: lon, lat: lat };\n            }\n        }, config);\n\n        this._config.width = config.container.clientWidth;\n        this._config.height = config.container.clientHeight;\n\n        config = this._config;\n\n        this._fix = {\n            lat: config.offsetLatitude || 0,\n            lon: config.offsetLongitude || 180,\n            isFixed: config.offsetLatitude || config.offsetLongitude\n        };\n\n        this._touch = this._orient = {\n            lat: 0,\n            lon: 0\n        };\n\n        this._initStage();\n        this.resize();\n        this._animate();\n        this._initControl();\n    }\n\n    _createClass(Panorama, [{\n        key: 'update',\n        value: function update() {\n            var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n            this._config = Object.assign({}, this._config, config);\n\n            if (config.width || config.height) {\n                this.renderer.setSize(this._config.width, this._config.height);\n                this.camera.aspect = this._config.width / this._config.height;\n            }\n            if (config.fov) {\n                this.camera.fov = config.fov;\n            }\n            this.camera.updateProjectionMatrix();\n            this.resize();\n        }\n    }, {\n        key: 'resize',\n        value: function resize() {\n            this.camera.lookAt(this.camera.target);\n            this.renderer.render(this.scene, this.camera);\n        }\n    }, {\n        key: '_initStage',\n        value: function _initStage() {\n            var _config = this._config,\n                container = _config.container,\n                width = _config.width,\n                height = _config.height,\n                url = _config.url,\n                fov = _config.fov,\n                radius = _config.radius;\n\n            this.camera = new THREE.PerspectiveCamera(fov, width / height, 1, 1100);\n            this.camera.target = new THREE.Vector3(0, 0, 0);\n            this.scene = new THREE.Scene();\n\n            var geometry = new THREE.SphereBufferGeometry(radius, 60, 40);\n            geometry.scale(-1, 1, 1);\n            var material = new THREE.MeshBasicMaterial({\n                map: new THREE.TextureLoader().load(url)\n            });\n            var mesh = new THREE.Mesh(geometry, material);\n            this.scene.add(mesh);\n\n            this.renderer = new THREE.WebGLRenderer();\n            this.renderer.setPixelRatio(window.devicePixelRatio);\n            this.renderer.setSize(width, height);\n            this.canvas = this.renderer.domElement;\n            container.appendChild(this.canvas);\n\n            window.addEventListener('resize', this._bindResize = this._onResize.bind(this));\n        }\n    }, {\n        key: '_onResize',\n        value: function _onResize() {\n            var container = this._config.container;\n\n            this.update({\n                width: container.clientWidth,\n                height: container.clientHeight\n            });\n        }\n    }, {\n        key: '_initControl',\n        value: function _initControl() {\n            var self = this;\n            var config = this._config;\n\n            if (config.supportTouch) {\n                var fov = void 0;\n                this._toucher = new _toucher2.default({\n                    container: config.container,\n                    radius: config.radius,\n                    onChange: function onChange(_ref) {\n                        var lon = _ref.lon,\n                            lat = _ref.lat,\n                            scale = _ref.scale;\n\n                        if (scale) {\n                            fov = self._config.fov / scale;\n                            fov = Math.min(120, Math.max(fov, 60));\n                            self.update({ fov: fov });\n                        }\n\n                        if (lon !== undefined && lat !== undefined) {\n                            //超出范围，用fix来补\n                            if (self._fix.lat + self._orient.lat + lat > 90) {\n                                self._fix.lat = 90 - self._orient.lat - lat;\n                            } else if (self._fix.lat + self._orient.lat + lat < -90) {\n                                self._fix.lat = -90 - self._orient.lat - lat;\n                            }\n                            self._touch = { lon: lon, lat: lat };\n                        }\n                    }\n                });\n            }\n\n            if (config.supportOrient) {\n                this._orienter = new _orienter2.default({\n                    onChange: function onChange(_ref2) {\n                        var lat = _ref2.lat,\n                            lon = _ref2.lon;\n                        var _fix = self._fix;\n\n                        if (!_fix.isFixed) {\n                            self._fix = {\n                                lat: _fix.lat - lat,\n                                lon: _fix.lon - lon,\n                                isFixed: true\n                            };\n                        }\n                        if (Math.abs(self._orient.lat - lat) >= 90) {\n                            return;\n                        }\n                        //超出范围，用fix来补\n                        if (self._fix.lat + self._touch.lat + lat > 90) {\n                            self._fix.lat = 90 - self._touch.lat - lat;\n                        } else if (self._fix.lat + self._touch.lat + lat < -90) {\n                            self._fix.lat = -90 - self._touch.lat - lat;\n                        }\n\n                        self._orient = { lat: lat, lon: lon };\n                    }\n                });\n            }\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            this._toucher && this._toucher.unbind();\n            this._orienter && this._orienter.destroy();\n            this._bindResize && window.removeEventListener('resize', this._bindResize);\n            cancelAnimationFrame(this._intFrame);\n        }\n    }, {\n        key: '_animate',\n        value: function _animate() {\n            var config = this._config;\n            var lat = this._touch.lat + this._fix.lat + this._orient.lat;\n            var lon = this._touch.lon + this._fix.lon + this._orient.lon;\n\n            //外部传的经纬度\n            var obj = config.onFrame(lon, lat);\n            lon += obj.lon || 0;\n            lat += obj.lat || 0;\n\n            lat = Math.max(-89, Math.min(89, lat));\n\n            lat = THREE.Math.degToRad(lat);\n            lon = THREE.Math.degToRad(lon);\n\n            this.camera.target.x = 500 * Math.cos(lat) * Math.cos(lon);\n            this.camera.target.y = 500 * Math.sin(lat);\n            this.camera.target.z = 500 * Math.cos(lat) * Math.sin(lon);\n\n            this.resize();\n            this._intFrame = requestAnimationFrame(this._animate.bind(this));\n        }\n    }]);\n\n    return Panorama;\n}();\n\nexports.default = Panorama;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Orienter = function () {\n    function Orienter(config) {\n        _classCallCheck(this, Orienter);\n\n        this._config = Object.assign({\n            onChange: function onChange() {},\n            onOrient: function onOrient() {}\n        }, config);\n\n        this.lon = this.lat = 0;\n        this.offsetMooth = 1;\n        this.direction = window.orientation || 0;\n        this.bind();\n    }\n\n    _createClass(Orienter, [{\n        key: 'bind',\n        value: function bind() {\n            window.addEventListener('deviceorientation', this._bindChange = this._onChange.bind(this));\n            window.addEventListener('orientationchange', this._bindOrient = this._onOrient.bind(this));\n        }\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            window.removeEventListener('deviceorientation', this._bindChange, false);\n            window.removeEventListener('orientationchange', this._bindOrient, false);\n        }\n    }, {\n        key: '_onOrient',\n        value: function _onOrient(event) {\n            this.direction = window.orientation;\n            this._config.onOrient(event);\n            this.lastLon = this.lastLat = undefined;\n        }\n    }, {\n        key: '_mooth',\n        value: function _mooth(x, lx) {\n            //插值为了平滑些\n            if (lx === undefined) {\n                return x;\n            }\n            if (Math.abs(x - lx) > this.offsetMooth) {\n                if (x > lx) {\n                    x = lx + this.offsetMooth;\n                } else {\n                    x = lx - this.offsetMooth;\n                }\n            } else {\n                x = lx;\n            }\n            return x;\n        }\n    }, {\n        key: '_onChange',\n        value: function _onChange(evt) {\n            switch (this.direction) {\n                case 0:\n                    this.lon = -(evt.alpha + evt.gamma);\n                    this.lat = evt.beta - 90;\n                    break;\n                case 90:\n                    this.lon = evt.alpha - Math.abs(evt.beta);\n                    this.lat = evt.gamma < 0 ? -90 - evt.gamma : 90 - evt.gamma;\n                    break;\n                case -90:\n                    this.lon = -(evt.alpha + Math.abs(evt.beta));\n                    this.lat = evt.gamma > 0 ? evt.gamma - 90 : 90 + evt.gamma;\n                    break;\n            }\n\n            this.lon = this.lon > 0 ? this.lon % 360 : this.lon % 360 + 360;\n\n            if (this.lastLat === undefined) {\n                this.lastLat = this.lat;\n            }\n\n            //lat变化跳动比较大，插值为了平滑些\n            this.lastLat = this.lat = this._mooth(this.lat, this.lastLat);\n\n            this._config.onChange({\n                lon: this.lon,\n                lat: this.lat\n            });\n        }\n    }]);\n\n    return Orienter;\n}();\n\nexports.default = Orienter;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Toucher = function () {\n    function Toucher(config) {\n        _classCallCheck(this, Toucher);\n\n        this.config = Object.assign({\n            radius: 50,\n            container: document.body,\n            onStart: function onStart() {},\n            onMove: function onMove() {},\n            onEnd: function onEnd() {},\n            onChange: function onChange() {}\n        }, config);\n        this.lat = this.lon = 0;\n        this.lastX = this.lastY = 0;\n        this.lastDistance = 0;\n        this.startX = this.startY = 0;\n        this.speed = { lat: 0, lon: 0 };\n        this.deceleration = 0.5;\n        this.factor = 50 / this.config.radius;\n        this.bind();\n    }\n\n    _createClass(Toucher, [{\n        key: 'bind',\n        value: function bind() {\n            var container = this.config.container;\n\n            container.addEventListener('touchstart', this._bindStart = this._onStart.bind(this));\n            container.addEventListener('touchmove', this._bindMove = this._onMove.bind(this));\n            container.addEventListener('touchend', this._bindEnd = this._onEnd.bind(this));\n        }\n    }, {\n        key: 'unbind',\n        value: function unbind() {\n            var container = this.config.container;\n\n            container.removeEventListener('touchstart', this._bindStart);\n            container.removeEventListener('touchmove', this._bindMove);\n            container.removeEventListener('touchend', this._bindEnd);\n        }\n    }, {\n        key: '_onStart',\n        value: function _onStart(event) {\n            var evt = event.changedTouches[0];\n            this.startX = this.lastX = evt.clientX;\n            this.startY = this.lastY = evt.clientY;\n            this.startTime = Date.now();\n            this.config.onStart(event);\n            this.speed = { lat: 0, lon: 0 };\n            this.lastDistance = undefined;\n        }\n    }, {\n        key: '_onMove',\n        value: function _onMove(event) {\n            event.preventDefault();\n            var evt = event.changedTouches[0];\n            switch (event.changedTouches.length) {\n                case 1:\n                    if (!this.lastDistance) {\n                        this.lon += (this.lastX - evt.clientX) * this.factor;\n                        this.lat += (evt.clientY - this.lastY) * this.factor;\n\n                        this.lastX = evt.clientX;\n                        this.lastY = evt.clientY;\n\n                        this.config.onChange({\n                            lat: this.lat,\n                            lon: this.lon\n                        });\n                    }\n                    break;\n                case 2:\n                    var evt1 = event.changedTouches[1];\n                    var distance = Math.abs(evt.clientX - evt1.clientX) + Math.abs(evt.clientY - evt1.clientY);\n                    if (this.lastDistance === undefined) {\n                        this.lastDistance = distance;\n                    }\n                    var scale = distance / this.lastDistance;\n\n                    if (scale) {\n                        this.config.onChange({ scale: scale });\n                        this.lastDistance = distance;\n                    }\n            }\n            this.config.onMove(event);\n        }\n    }, {\n        key: '_onEnd',\n        value: function _onEnd(event) {\n            //惯性\n            var t = (Date.now() - this.startTime) / 10;\n            this.speed = {\n                lat: (this.startY - this.lastY) / t,\n                lon: (this.startX - this.lastX) / t\n            };\n\n            this._inertance();\n            this.config.onEnd(event);\n        }\n    }, {\n        key: '_subSpeed',\n        value: function _subSpeed(speed) {\n            if (speed !== 0) {\n                if (speed > 0) {\n                    speed -= this.deceleration;\n                    speed < 0 && (speed = 0);\n                } else {\n                    speed += this.deceleration;\n                    speed > 0 && (speed = 0);\n                }\n            }\n            return speed;\n        }\n    }, {\n        key: '_inertance',\n        value: function _inertance() {\n            var speed = this.speed;\n            speed.lat = this._subSpeed(speed.lat);\n            speed.lon = this._subSpeed(speed.lon);\n\n            this.lat -= speed.lat;\n            this.lon += speed.lon;\n\n            this.config.onChange({\n                isUserInteracting: false,\n                speed: speed,\n                lat: this.lat,\n                lon: this.lon\n            });\n\n            if (speed.lat === 0 && speed.lon === 0) {\n                this._intFrame && cancelAnimationFrame(this._intFrame);\n                this._intFrame = 0;\n            } else {\n                this._intFrame = requestAnimationFrame(this._inertance.bind(this));\n            }\n        }\n    }]);\n\n    return Toucher;\n}();\n\nexports.default = Toucher;\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// panorama.js?ed464704257860ee4439"," \t// install a JSONP callback for chunk loading\n \tvar parentJsonpFunction = window[\"webpackJsonp\"];\n \twindow[\"webpackJsonp\"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [], result;\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n \t\tif(executeModules) {\n \t\t\tfor(i=0; i < executeModules.length; i++) {\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = executeModules[i]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t};\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// objects to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData === 0) {\n \t\t\treturn new Promise(function(resolve) { resolve(); });\n \t\t}\n\n \t\t// a Promise means \"currently loading\".\n \t\tif(installedChunkData) {\n \t\t\treturn installedChunkData[2];\n \t\t}\n\n \t\t// setup Promise in chunk cache\n \t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t});\n \t\tinstalledChunkData[2] = promise;\n\n \t\t// start chunk loading\n \t\tvar head = document.getElementsByTagName('head')[0];\n \t\tvar script = document.createElement('script');\n \t\tscript.type = 'text/javascript';\n \t\tscript.charset = 'utf-8';\n \t\tscript.async = true;\n \t\tscript.timeout = 120000;\n\n \t\tif (__webpack_require__.nc) {\n \t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t}\n \t\tscript.src = __webpack_require__.p + \"\" + chunkId + \".js?\" + {\"0\":\"b40cb0b5c4f3dbea9676\"}[chunkId] + \"\";\n \t\tvar timeout = setTimeout(onScriptComplete, 120000);\n \t\tscript.onerror = script.onload = onScriptComplete;\n \t\tfunction onScriptComplete() {\n \t\t\t// avoid mem leaks in IE.\n \t\t\tscript.onerror = script.onload = null;\n \t\t\tclearTimeout(timeout);\n \t\t\tvar chunk = installedChunks[chunkId];\n \t\t\tif(chunk !== 0) {\n \t\t\t\tif(chunk) {\n \t\t\t\t\tchunk[1](new Error('Loading chunk ' + chunkId + ' failed.'));\n \t\t\t\t}\n \t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t}\n \t\t};\n \t\thead.appendChild(script);\n\n \t\treturn promise;\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2ba1bcd0b8b0d25eba99","import Orienter from './orienter'\r\nimport Toucher from './toucher'\r\n\r\nexport default class Panorama {\r\n    constructor(config) {\r\n        this._config = Object.assign({\r\n            url: '',                    //全景图片\r\n            container: document.body,   //容器\r\n            radius: 500,                //球体半径\r\n            fov: 90,                    //相机视角，可用于放大和缩小图片\r\n            offsetLongitude: 0,         //经度偏移量，可用于默认展示图片位置\r\n            offsetLatitude: 0,          //纬度偏移量，可用于默认展示图片位置\r\n            supportTouch: true,         //是否支持手指滑动\r\n            supportOrient: true,        //是否支持陀螺仪\r\n            onFrame(lon, lat) {\r\n                return {lon, lat};\r\n            }\r\n        }, config);\r\n\r\n\r\n        this._config.width = config.container.clientWidth;\r\n        this._config.height = config.container.clientHeight;\r\n\r\n\r\n        config = this._config;\r\n\r\n        this._fix = {\r\n            lat: config.offsetLatitude || 0,\r\n            lon: config.offsetLongitude || 180,\r\n            isFixed: config.offsetLatitude || config.offsetLongitude\r\n        };\r\n\r\n        this._touch = this._orient = {\r\n            lat: 0,\r\n            lon: 0\r\n        };\r\n\r\n        this._initStage();\r\n        this.resize();\r\n        this._animate();\r\n        this._initControl();\r\n    }\r\n\r\n\r\n    update(config = {}) {\r\n        this._config = Object.assign({}, this._config, config);\r\n\r\n        if (config.width || config.height) {\r\n            this.renderer.setSize(this._config.width, this._config.height);\r\n            this.camera.aspect = this._config.width / this._config.height;\r\n        }\r\n        if (config.fov) {\r\n            this.camera.fov = config.fov;\r\n        }\r\n        this.camera.updateProjectionMatrix();\r\n        this.resize();\r\n    }\r\n\r\n    resize() {\r\n        this.camera.lookAt(this.camera.target);\r\n        this.renderer.render(this.scene, this.camera);\r\n    }\r\n\r\n    _initStage() {\r\n        const {container, width, height, url, fov, radius} = this._config;\r\n        this.camera = new THREE.PerspectiveCamera(fov, width / height, 1, 1100);\r\n        this.camera.target = new THREE.Vector3(0, 0, 0);\r\n        this.scene = new THREE.Scene();\r\n\r\n        var geometry = new THREE.SphereBufferGeometry(radius, 60, 40);\r\n        geometry.scale(-1, 1, 1);\r\n        var material = new THREE.MeshBasicMaterial({\r\n            map: new THREE.TextureLoader().load(url)\r\n        });\r\n        var mesh = new THREE.Mesh(geometry, material);\r\n        this.scene.add(mesh);\r\n\r\n        this.renderer = new THREE.WebGLRenderer();\r\n        this.renderer.setPixelRatio(window.devicePixelRatio);\r\n        this.renderer.setSize(width, height);\r\n        this.canvas = this.renderer.domElement;\r\n        container.appendChild(this.canvas);\r\n\r\n        window.addEventListener('resize', this._bindResize = this._onResize.bind(this));\r\n    }\r\n\r\n    _onResize() {\r\n        const {container} = this._config;\r\n        this.update({\r\n            width: container.clientWidth,\r\n            height: container.clientHeight\r\n        });\r\n    }\r\n\r\n    _initControl() {\r\n        const self = this;\r\n        const config = this._config;\r\n\r\n        if (config.supportTouch) {\r\n            let fov;\r\n            this._toucher = new Toucher({\r\n                container: config.container,\r\n                radius: config.radius,\r\n                onChange({lon, lat, scale}) {\r\n                    if (scale) {\r\n                        fov = self._config.fov / scale;\r\n                        fov = Math.min(120, Math.max(fov, 60));\r\n                        self.update({fov});\r\n                    }\r\n\r\n                    if (lon !== undefined && lat !== undefined) {\r\n                        //超出范围，用fix来补\r\n                        if (self._fix.lat + self._orient.lat + lat > 90) {\r\n                            self._fix.lat = 90 - self._orient.lat - lat;\r\n                        } else if (self._fix.lat + self._orient.lat + lat < -90) {\r\n                            self._fix.lat = -90 - self._orient.lat - lat;\r\n                        }\r\n                        self._touch = {lon, lat};\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        if (config.supportOrient) {\r\n            this._orienter = new Orienter({\r\n                onChange({lat, lon}) {\r\n                    const {_fix} = self;\r\n                    if (!_fix.isFixed) {\r\n                        self._fix = {\r\n                            lat: _fix.lat - lat,\r\n                            lon: _fix.lon - lon,\r\n                            isFixed: true\r\n                        };\r\n                    }\r\n                    if (Math.abs(self._orient.lat - lat) >= 90) {\r\n                        return;\r\n                    }\r\n                    //超出范围，用fix来补\r\n                    if (self._fix.lat + self._touch.lat + lat > 90) {\r\n                        self._fix.lat = 90 - self._touch.lat - lat;\r\n                    } else if (self._fix.lat + self._touch.lat + lat < -90) {\r\n                        self._fix.lat = -90 - self._touch.lat - lat;\r\n                    }\r\n\r\n                    self._orient = {lat, lon};\r\n                }\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    destroy() {\r\n        this._toucher && this._toucher.unbind();\r\n        this._orienter && this._orienter.destroy();\r\n        this._bindResize && window.removeEventListener('resize', this._bindResize);\r\n        cancelAnimationFrame(this._intFrame);\r\n    }\r\n\r\n    _animate() {\r\n        const config = this._config;\r\n        let lat = this._touch.lat + this._fix.lat + this._orient.lat;\r\n        let lon = this._touch.lon + this._fix.lon + this._orient.lon;\r\n\r\n        //外部传的经纬度\r\n        let obj = config.onFrame(lon, lat);\r\n        lon += (obj.lon || 0);\r\n        lat += (obj.lat || 0);\r\n\r\n\r\n        lat = Math.max(-89, Math.min(89, lat));\r\n\r\n        lat = THREE.Math.degToRad(lat);\r\n        lon = THREE.Math.degToRad(lon);\r\n\r\n        this.camera.target.x = 500 * Math.cos(lat) * Math.cos(lon);\r\n        this.camera.target.y = 500 * Math.sin(lat);\r\n        this.camera.target.z = 500 * Math.cos(lat) * Math.sin(lon);\r\n\r\n        this.resize();\r\n        this._intFrame = requestAnimationFrame(this._animate.bind(this));\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/panorama.js","export default class Orienter {\r\n    constructor(config) {\r\n        this._config = Object.assign({\r\n            onChange() {\r\n            },\r\n            onOrient() {\r\n            }\r\n        }, config);\r\n\r\n        this.lon = this.lat = 0;\r\n        this.offsetMooth = 1;\r\n        this.direction = window.orientation || 0;\r\n        this.bind();\r\n    }\r\n\r\n\r\n    bind() {\r\n        window.addEventListener('deviceorientation', this._bindChange = this._onChange.bind(this));\r\n        window.addEventListener('orientationchange', this._bindOrient = this._onOrient.bind(this));\r\n    }\r\n\r\n\r\n    destroy() {\r\n        window.removeEventListener('deviceorientation', this._bindChange, false);\r\n        window.removeEventListener('orientationchange', this._bindOrient, false);\r\n    }\r\n\r\n\r\n    _onOrient(event) {\r\n        this.direction = window.orientation;\r\n        this._config.onOrient(event);\r\n        this.lastLon = this.lastLat = undefined\r\n    }\r\n\r\n    _mooth(x, lx) { //插值为了平滑些\r\n        if (lx === undefined) {\r\n            return x;\r\n        }\r\n        if (Math.abs(x - lx) > this.offsetMooth) {\r\n            if (x > lx) {\r\n                x = lx + this.offsetMooth;\r\n            } else {\r\n                x = lx - this.offsetMooth;\r\n            }\r\n        } else {\r\n            x = lx;\r\n        }\r\n        return x;\r\n    }\r\n\r\n    _onChange(evt) {\r\n        switch (this.direction) {\r\n            case 0 :\r\n                this.lon = -(evt.alpha + evt.gamma);\r\n                this.lat = evt.beta - 90;\r\n                break;\r\n            case 90:\r\n                this.lon = evt.alpha - Math.abs(evt.beta);\r\n                this.lat = evt.gamma < 0 ? -90 - evt.gamma : 90 - evt.gamma;\r\n                break;\r\n            case -90:\r\n                this.lon = -(evt.alpha + Math.abs(evt.beta));\r\n                this.lat = evt.gamma > 0 ? evt.gamma - 90 : 90 + evt.gamma;\r\n                break;\r\n        }\r\n\r\n        this.lon = this.lon > 0 ? this.lon % 360 : this.lon % 360 + 360;\r\n\r\n        if (this.lastLat === undefined) {\r\n            this.lastLat = this.lat;\r\n        }\r\n\r\n        //lat变化跳动比较大，插值为了平滑些\r\n        this.lastLat = this.lat = this._mooth(this.lat, this.lastLat);\r\n\r\n        this._config.onChange({\r\n            lon: this.lon,\r\n            lat: this.lat\r\n        });\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/orienter.js","export default class Toucher {\r\n    constructor(config) {\r\n        this.config = Object.assign({\r\n            radius: 50,\r\n            container: document.body,\r\n            onStart() {\r\n            },\r\n            onMove() {\r\n            },\r\n            onEnd() {\r\n            },\r\n            onChange() {\r\n            }\r\n        }, config);\r\n        this.lat = this.lon = 0;\r\n        this.lastX = this.lastY = 0;\r\n        this.lastDistance = 0;\r\n        this.startX = this.startY = 0;\r\n        this.speed = {lat: 0, lon: 0};\r\n        this.deceleration = 0.5;\r\n        this.factor = 50 / this.config.radius;\r\n        this.bind();\r\n    }\r\n\r\n    bind() {\r\n        const {container} = this.config;\r\n        container.addEventListener('touchstart', this._bindStart = this._onStart.bind(this));\r\n        container.addEventListener('touchmove', this._bindMove = this._onMove.bind(this));\r\n        container.addEventListener('touchend', this._bindEnd = this._onEnd.bind(this));\r\n\r\n    }\r\n\r\n    unbind() {\r\n        const {container} = this.config;\r\n        container.removeEventListener('touchstart', this._bindStart);\r\n        container.removeEventListener('touchmove', this._bindMove);\r\n        container.removeEventListener('touchend', this._bindEnd);\r\n    }\r\n\r\n    _onStart(event) {\r\n        const evt = event.changedTouches[0];\r\n        this.startX = this.lastX = evt.clientX;\r\n        this.startY = this.lastY = evt.clientY;\r\n        this.startTime = Date.now();\r\n        this.config.onStart(event);\r\n        this.speed = {lat: 0, lon: 0};\r\n        this.lastDistance = undefined;\r\n    }\r\n\r\n    _onMove(event) {\r\n        event.preventDefault();\r\n        const evt = event.changedTouches[0];\r\n        switch (event.changedTouches.length) {\r\n            case 1 :\r\n                if (!this.lastDistance) {\r\n                    this.lon += (this.lastX - evt.clientX) * this.factor;\r\n                    this.lat += (evt.clientY - this.lastY) * this.factor;\r\n\r\n                    this.lastX = evt.clientX;\r\n                    this.lastY = evt.clientY;\r\n\r\n                    this.config.onChange({\r\n                        lat: this.lat,\r\n                        lon: this.lon\r\n                    });\r\n                }\r\n                break;\r\n            case 2:\r\n                const evt1 = event.changedTouches[1];\r\n                let distance = Math.abs(evt.clientX - evt1.clientX) + Math.abs(evt.clientY - evt1.clientY);\r\n                if (this.lastDistance === undefined) {\r\n                    this.lastDistance = distance;\r\n                }\r\n                let scale = distance / this.lastDistance;\r\n\r\n                if (scale) {\r\n                    this.config.onChange({scale});\r\n                    this.lastDistance = distance;\r\n                }\r\n        }\r\n        this.config.onMove(event);\r\n    }\r\n\r\n    _onEnd(event) {\r\n        //惯性\r\n        let t = (Date.now() - this.startTime) / 10;\r\n        this.speed = {\r\n            lat: (this.startY - this.lastY) / t,\r\n            lon: (this.startX - this.lastX) / t\r\n        };\r\n\r\n        this._inertance();\r\n        this.config.onEnd(event);\r\n    }\r\n\r\n    _subSpeed(speed) {\r\n        if (speed !== 0) {\r\n            if (speed > 0) {\r\n                speed -= this.deceleration;\r\n                speed < 0 && (speed = 0);\r\n            } else {\r\n                speed += this.deceleration;\r\n                speed > 0 && (speed = 0);\r\n            }\r\n        }\r\n        return speed;\r\n    }\r\n\r\n    _inertance() {\r\n        const speed = this.speed;\r\n        speed.lat = this._subSpeed(speed.lat);\r\n        speed.lon = this._subSpeed(speed.lon);\r\n\r\n        this.lat -= speed.lat;\r\n        this.lon += speed.lon;\r\n\r\n\r\n        this.config.onChange({\r\n            isUserInteracting: false,\r\n            speed,\r\n            lat: this.lat,\r\n            lon: this.lon\r\n        });\r\n\r\n        if (speed.lat === 0 && speed.lon === 0) {\r\n            this._intFrame && cancelAnimationFrame(this._intFrame);\r\n            this._intFrame = 0;\r\n        } else {\r\n            this._intFrame = requestAnimationFrame(this._inertance.bind(this));\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/lib/toucher.js"],"sourceRoot":""}